<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Register | Hardcore Gacha</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bungee&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style/index.css" />
    <link rel="icon" type="image/png" href="img/logo.png" />
  </head>
  <body>
    <div id="particles"></div>

    <div class="container bungee-regular">
      <div class="login-wrapper">
        <div class="login-box">
          <div class="logo">
            <img src="img/logo.png" alt="logo" />
          </div>
          <h1 class="title">Register</h1>
          <p class="subtitle">Create your account to start your journey</p>

          <div class="form">
            <input
              type="text"
              id="username"
              placeholder="Username"
              autocomplete="off"
            />
            <input
              type="password"
              id="password"
              placeholder="Password"
              autocomplete="off"
            />

            <button id="btnRegister" class="login-btn bungee-regular">
              Register
            </button>

            <div class="bottom-text">
              Already have an account?
              <a href="login.html">Login</a>
            </div>
          </div>

          <div id="status" class="status"></div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>
    <script src="api.js?v=1"></script>
    <script>
      tsParticles.load("particles", {
        particles: {
          number: { value: 80 },
          color: { value: "#ffffff" },
          shape: { type: "circle" },
          opacity: { value: 0.5 },
          size: { value: 2 },
          move: {
            enable: true,
            speed: 3,
            direction: "top",
            random: true,
            outModes: "out",
          },
        },
        background: { color: "transparent" },
      });
    </script>

    <script>
      const btn = document.getElementById("btnRegister");
      const statusBox = document.getElementById("status");

      btn.addEventListener("click", async () => {
        const username = document.getElementById("username").value.trim();
        const password = document.getElementById("password").value.trim();
        statusBox.textContent = "Registering...";

        try {
          const res = await api.register(username, password);
          if (res.token) {
            localStorage.setItem("token", res.token);
            statusBox.textContent = "✅ Registration successful!";
            window.location.href = "index.html";
          } else {
            statusBox.textContent = "❌ Invalid response.";
          }
        } catch (e) {
          statusBox.textContent = "❌ " + e.message;
        }
      });
    </script>
  </body>
</html>
